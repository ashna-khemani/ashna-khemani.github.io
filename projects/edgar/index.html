<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>edgar | Ashna Khemani</title> <meta name="author" content="Ashna Khemani"> <meta name="description" content="change up (2020-21)"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%8B&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ashna-khemani.github.io/projects/edgar/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Ashna </span>Khemani</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">edgar</h1> <p class="post-description">change up (2020-21)</p> </header> <article> <p><em>Robot name origin: an early version of this bot made concerning noises while driving (it still worked) that reminded us of of haunting works of Edgar Allen Poe.</em></p> <p>Curveball for this year: doing the entire season virtually and with fewer sponsors (thanks COVID). But I made it work. <a href="https://www.youtube.com/watch?v=Hxs0q9UoMDQ" rel="external nofollow noopener" target="_blank">Here’s</a> the challenge video for Change Up.</p> <p>With limited resources (and space in garages and living rooms), build took longer this year, and it was easy to feel frustrated and hopeless. But we did the best we could using what we had, and created Edgar. Though he didn’t look super clean and made rattly noises when driving, he worked, and that’s what I cared about for now.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/edgar-480.webp 480w, /assets/img/edgar-800.webp 800w, /assets/img/edgar-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/edgar.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Edgar, a somewhat demented but very functional robot made entirely out of scrap pieces we happened to have on hand. </div> <p><strong>Cool subsystems and specs:</strong></p> <ul> <li>Not a subsystem but you’d be surprised how much Edgar relies on rubberbands, masking tape, and friction mesh.</li> <li>Torqued down (sped) powertrain (in this virtual season, there were no heavy loads to push or other bots to defensively push around. But there <em>was</em> a need for speed)</li> <li>PID control! Scroll to the bottom for code.</li> </ul> <p>From our realization last year, I decided to focus pretty much entirely on the Skills challenge this year, especially since the Virtual Tournaments were similar to Skills anyway.</p> <p>Again, with a ton of driving strategy and practice, I was able to get close to maxing out the highest possible score in the Driver Skills challenge. ***video coming soon</p> <p>Though I had an autonomous code last year I knew it could be, in the words of Daft Punk, “better, faster, stronger.” I therefore started use sensors beyond the quadrature encoders we had been relying on, implementing ultrasonic sensors and an IMU. They were a step up, but I had heard of <strong>PID control</strong>, which I was dying to try. I worried that it might be a waste of time and not be worth it, but I jumped in. It took many Google searches, YouTube videos, and failed tests that nearly broke Edgar, but I finally got excellent PID loop for driving.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <iframe width="747" height="376" src="https://www.youtube.com/embed/iapxfOCZfn8" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe> </div> </div> <div class="caption"> A successful run of Edgar driving autonomously with PID control. </div> <p>Hyperfocusing on Skills helped me become a stronger all-rounder, and my team won multiple remote competitions, Skills Challenges, and several awards. We were even ranked in the Top 100 worldwide! Since everything was remote, I was able to compete in many more events. My ability to strategize, communicate at lightning speed with my team, and think under pressure on the spot grew much stronger.</p> <p>And this helped me not only qualify for the (Virtual) World Championship, but even get to the <strong>Division Semifinals</strong>. I had started the year skeptical of what I could achieve with limited resources, but I believe I truly made the best of it, learned, and reached a level higher than I’d ever expected.</p> <h3 id="pid-code">PID Code</h3> <p>If you’re curious, the PID code (well, technically it’s more of a PI) can be viewed <a href="https://github.com/anandananya/Vex2021ChangeUp/blob/6523d6ddc1525c1b23637f820998c39f9accd091/World%20v1%20050921/src/bot-functions.cpp#L79C1-L79C1" rel="external nofollow noopener" target="_blank">here</a>. Here it is copied (in-progress comments and all…):</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">drivePI</span><span class="p">(</span><span class="kt">double</span> <span class="n">targetDistance</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Brain.Screen.print("HEY BESTIE UWU");</span>
  <span class="kt">double</span> <span class="n">motorspeed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">currentDistance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
         <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">targetDistance</span> <span class="o">-</span> <span class="n">currentDistance</span><span class="p">),</span> <span class="n">errorSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">deltaE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
         <span class="n">lastError</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">maxAllowedError</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">errorTimerMax</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">kP</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">kI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kD</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c1">//working 8,0,20</span>
  <span class="kt">bool</span> <span class="n">timerExpired</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="n">timer</span> <span class="n">errorTimer</span> <span class="o">=</span> <span class="n">timer</span><span class="p">();</span>
  <span class="n">errorTimer</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
  <span class="n">FrontRightMotor</span>
      <span class="p">.</span><span class="n">resetRotation</span><span class="p">();</span> <span class="c1">// used front right motor to control driving distance</span>
  <span class="n">FrontLeftMotor</span><span class="p">.</span><span class="n">resetRotation</span><span class="p">();</span>

  <span class="k">while</span> <span class="p">((</span><span class="n">fabs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxAllowedError</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">timerExpired</span> <span class="o">==</span> <span class="nb">false</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">currentDistance</span> <span class="o">=</span> <span class="p">((</span><span class="n">FrontRightMotor</span><span class="p">.</span><span class="n">rotation</span><span class="p">(</span><span class="n">rotationUnits</span><span class="o">::</span><span class="n">deg</span><span class="p">)</span> <span class="o">+</span>
                        <span class="n">FrontLeftMotor</span><span class="p">.</span><span class="n">rotation</span><span class="p">(</span><span class="n">rotationUnits</span><span class="o">::</span><span class="n">deg</span><span class="p">))</span> <span class="o">/</span>
                       <span class="mi">2</span> <span class="o">/</span> <span class="mi">360</span><span class="p">)</span> <span class="o">*</span>
                      <span class="n">WHEELCIRCUMFERENCE</span><span class="p">;</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">targetDistance</span> <span class="o">-</span> <span class="n">currentDistance</span><span class="p">;</span>
    <span class="n">errorSum</span> <span class="o">+=</span> <span class="n">error</span><span class="p">;</span>
    <span class="n">deltaE</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span> <span class="o">-</span> <span class="n">lastError</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5000</span><span class="p">;</span>
    <span class="c1">//** deltaE = (lastError - error)/-500? How do u get the value of the error</span>
    <span class="c1">//at a given time IN EQUAL INTERVALS)??</span>
    <span class="n">motorspeed</span> <span class="o">=</span> <span class="p">(</span><span class="n">error</span> <span class="o">*</span> <span class="n">kP</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">errorSum</span> <span class="o">*</span> <span class="n">kI</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">deltaE</span> <span class="o">*</span> <span class="n">kD</span><span class="p">);</span>

    <span class="n">BackLeftMotor</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">directionType</span><span class="o">::</span><span class="n">fwd</span><span class="p">,</span> <span class="n">motorspeed</span><span class="p">,</span> <span class="n">velocityUnits</span><span class="o">::</span><span class="n">pct</span><span class="p">);</span>
    <span class="n">FrontLeftMotor</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">directionType</span><span class="o">::</span><span class="n">fwd</span><span class="p">,</span> <span class="n">motorspeed</span><span class="p">,</span> <span class="n">velocityUnits</span><span class="o">::</span><span class="n">pct</span><span class="p">);</span>
    <span class="n">FrontRightMotor</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">directionType</span><span class="o">::</span><span class="n">fwd</span><span class="p">,</span> <span class="n">motorspeed</span><span class="p">,</span> <span class="n">velocityUnits</span><span class="o">::</span><span class="n">pct</span><span class="p">);</span>
    <span class="n">BackRightMotor</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">directionType</span><span class="o">::</span><span class="n">fwd</span><span class="p">,</span> <span class="n">motorspeed</span><span class="p">,</span> <span class="n">velocityUnits</span><span class="o">::</span><span class="n">pct</span><span class="p">);</span>

    <span class="n">lastError</span> <span class="o">=</span> <span class="n">error</span><span class="p">;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxAllowedError</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">errorTimer</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">errorTimer</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">errorTimerMax</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">timerExpired</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">vex</span><span class="o">::</span><span class="n">task</span><span class="o">::</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">BackLeftMotor</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">brake</span><span class="p">);</span>
  <span class="n">FrontLeftMotor</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">brake</span><span class="p">);</span>
  <span class="n">FrontRightMotor</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">brake</span><span class="p">);</span>
  <span class="n">BackRightMotor</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="n">brake</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Ashna Khemani. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>